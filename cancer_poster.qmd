---
title: Visualizing Measles Incidence in the USA (1928--2001)
format:
  poster-typst: 
    size: "33x23" # Approximately A1
    poster-authors: "Michael T. Gastner"
    departments: "Information and Communication Technologies"
    institution-logo: "./images/sit-logo.png"
    footer-text: "Information Visualization 2024"
    footer-emails: "michael.gastner@singaporetech.edu.sg"
execute:
  echo: false
knitr:
  opts_chunk:
    dev: svglite
---

```{r}
#| label: setup
#| include: false

library(knitr)
purl("measles_prep.qmd")
source("measles_prep.R")
```


# Introduction

Measles is a highly contagious viral infection that can lead to severe complications, including pneumonia, encephalitis, and death. The average number of secondary cases resulting from a single infected individual is estimated to be between 10 and 16,[^guerra_basic_2017] but vaccination is reported to be 97% effective at preventing measles[^franconeri_two-dose_2023]. Consequently, the introduction of the vaccine in 1963 was followed by a significant decline in measles incidence in the USA.

[^guerra_basic_2017]: F. M. Guerra et al., “The basic reproduction number (R0) of measles: a systematic review,” The Lancet Infectious Diseases, vol. 17, no. 12, p. e420-e428, 2017
[^franconeri_two-dose_2023]: L. Franconeri et al., “Two-dose measles vaccine effectiveness remains high over time: A French observational study, 2017–2019,” Vaccine, vol. 41, no. 39, pp. 5797–5804, 2023]

Given persistent skepticism in some communities about the efficacy of vaccines, it is important to communicate the impact of vaccination on public health. In this project, we built on a visualization of the measles incidence in the USA published by the Wall Street Journal[^debold_battling_2015] (@fig-wsj-on-poster). This visualization has garnered praise as "One of the more compelling data visualizations produced in recent years"[^lee_reproducing_2017]. However, we contend that, despite its effectiveness in summarizing data, several aspects of the plot can be improved.

[^lee_reproducing_2017]: <https://www.mikelee.co/posts/2017-06-28-wsj-measles-vaccination-chart>

# Previous Visualization

```{r}
#| label: fig-wsj-on-poster
#| fig-cap: "Measles incidence by state of the USA and year, published by the
#|   Wall Street Journal."
#| out-width: 100%

include_graphics("images/wsj_cropped.png")
```

[^debold_battling_2015]: <https://graphics.wsj.com/infectious-diseases-and-vaccines/>

# Strengths

*   The heatmap design effectively conveys a high information content without
    cluttering the plot.
*   Pointing with the mouse at a tile opens an infotip, enabling readers to
    retrieve specific incidence data for a given state and
    year (@fig-infotip_color_change). The infotip only occludes a small
    portion of the plot, and the partial transparency of the infotip ensures
    visibility of the tiles underneath.
*   The vertical line indicating the year of vaccine introduction provides
    valuable contextual information.

```{r}
#| label: fig-infotip_color_change
#| fig-cap: "Zoomed-in screenshot of the original plot with and without
#|   activated infotip."
#| out-width: 100%

include_graphics("images/infotip_color_change.png")
```


# Suggested Improvements

1. *Enhance informativeness* by adding demographic comparisons, such as cancer death rates by gender.
2. *Improve clarity and understanding* on cancer death statistics by grouping similar cancer types together.
3. Add in labsl to both the x and y-axis for *improved clarity*.
4. Provide exact whole numbers instead of estimates to *enhance comprehension and clarity*.
5. Incorporate a straightforward and *visually appealing* colour scheme to *improve the chart’s appearance*.
6. Include a colour legend to explain the meaning of the colours used.
7. Sort the values in descending order according to the total deaths to *highlight the most critical cancer types*.
8. Include grid lines at *meaningful intervals*, such as every 500,000, considering the value range extends up to a million.

# Implementation


## Data

*   The cancer deaths by type chart was sourced from Our World In Data [^our_world_in_data_chart]. During data preparation, unnecessary columns were removed and cancer names were abbreviated for better visualization. We rounded death values for consistency and grouped cancer types by gender, allowing us to create a bi-directional bar chart for comparing different types of cancer deaths across genders.

*   Data source was gathered from IHME, Global Burden of Disease. (2024) [^cancer_dataset]

[^our_world_in_data_chart]: <https://ourworldindata.org/cancer>
[^cancer_dataset]: <https://vizhub.healthdata.org/gbd-results/>


## Software

In our project, we employed Quarto along with the R programming language. We integrated various third-party libraries categorized by their respective purposes:

*Data Import:
*readr*: reads csv files into R

*Data Manipulation & Tidying:
*dplyr*: filters, selects and arranges data
*tidyr*: reshapes data frames to a tidy format

*Data Visualization:
*ggplot2*: creates graphics based on Grammer of Graphics
*ggnewscale*: applies multiple colours and fill scales within plots
*RColorBrewer*: provides addition colour palettes for graphics
*scales*: handles various aspects of scaling data


```{=typst}
#v(2em)
```

# Improved Visualization

```{r}
#| label: fig-ggplot
#| fig-cap: "Revised visualization of measles incidence by state of the USA and
#|  year."
#| fig-width: 6.0
#| fig-height: 5.8
#| out-width: 100%

g <-
  ggplot(measles, aes(year + 0.5, state, fill = incidence + 1e-6)) +
  geom_tile(width = 0.75, height = 0.75) +
  geom_vline(xintercept = 1963, colour = "darkblue", linewidth = 1) +
  annotate(
    "label",
    label = "Vaccine introduced",
    x = 1963,
    y = 60, # 54.5,
    vjust = 1,
    hjust = 0
  ) +
  labs(
    x = "Year",
    y = NULL,
    fill = "Mean weekly incidence\n(per 100,000) if known",
    title = "Measles in the USA by State",
    caption = "Source: Project Tycho"
  ) +
  scale_x_continuous(expand = expansion(0.01, 0)) +
  scale_y_discrete(limits = rev, position = "right") +
  scale_fill_fermenter(
    breaks = 10^(-2:3),
    labels = prettyNum,
    trans = "log10",
    palette = "Reds",
    direction = 1,
    na.value = "#ffffff00",
  ) +
  guides(
    y = guide_axis(n.dodge = 2),
    fill = guide_coloursteps(frame.colour = "gray", direction = "horizontal")
  ) +
  theme_minimal() +
  theme(
    legend.key.size = unit(0.75, "cm"),
    legend.title = element_text(hjust = 1, vjust = 1),
    legend.position = "top",
    panel.grid.major.x = element_line(colour = "gray", linewidth = 0.5),
    panel.grid.minor.x = element_line(colour = "gray", linewidth = 0.5),
    panel.grid.major.y = element_line(colour = "gray", linewidth = c(0, 0.5)),
    plot.title = element_text(hjust = 0.5)
  )
g
```


# Further Suggestions for Interactivity

As our visualization is designed for static clarity on a poster, it might be lacking some interactivity. Moving to a digital format like HTML with tools such as Plotly in R could enhance user engagement. Features like hover-over tooltips (values, etc), detailed categorical breakdowns (specific cancer organ), and yearly trend analysis would provide further dynamic insights and enrich user interaction.

# Conclusion

We successfully addressed our initial criticisms of the old visualization and implemented our improvements in our new visualization. By ensuring consistent cancer type categorization and including data split by gender in a bi-directional graph, the updated chart now offers a clearer and more detailed view. We also improved accessibility with a colorblind-safe palette and added a detailed legend, enhancing overall visual appeal. These enhancements aim to make the visualization more user-friendly and inclusive, enabling deeper exploration and understanding of disease trends across genders for a diverse audience.